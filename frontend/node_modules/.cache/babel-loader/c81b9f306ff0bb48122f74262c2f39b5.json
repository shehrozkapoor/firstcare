{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar lodash_clonedeep_1 = __importDefault(require(\"lodash.clonedeep\"));\n\nvar lodash_isequal_1 = __importDefault(require(\"lodash.isequal\"));\n\nvar AttributeMap;\n\n(function (AttributeMap) {\n  function compose(a, b, keepNull) {\n    if (a === void 0) {\n      a = {};\n    }\n\n    if (b === void 0) {\n      b = {};\n    }\n\n    if (typeof a !== 'object') {\n      a = {};\n    }\n\n    if (typeof b !== 'object') {\n      b = {};\n    }\n\n    var attributes = lodash_clonedeep_1.default(b);\n\n    if (!keepNull) {\n      attributes = Object.keys(attributes).reduce(function (copy, key) {\n        if (attributes[key] != null) {\n          copy[key] = attributes[key];\n        }\n\n        return copy;\n      }, {});\n    }\n\n    for (var key in a) {\n      if (a[key] !== undefined && b[key] === undefined) {\n        attributes[key] = a[key];\n      }\n    }\n\n    return Object.keys(attributes).length > 0 ? attributes : undefined;\n  }\n\n  AttributeMap.compose = compose;\n\n  function diff(a, b) {\n    if (a === void 0) {\n      a = {};\n    }\n\n    if (b === void 0) {\n      b = {};\n    }\n\n    if (typeof a !== 'object') {\n      a = {};\n    }\n\n    if (typeof b !== 'object') {\n      b = {};\n    }\n\n    var attributes = Object.keys(a).concat(Object.keys(b)).reduce(function (attrs, key) {\n      if (!lodash_isequal_1.default(a[key], b[key])) {\n        attrs[key] = b[key] === undefined ? null : b[key];\n      }\n\n      return attrs;\n    }, {});\n    return Object.keys(attributes).length > 0 ? attributes : undefined;\n  }\n\n  AttributeMap.diff = diff;\n\n  function invert(attr, base) {\n    if (attr === void 0) {\n      attr = {};\n    }\n\n    if (base === void 0) {\n      base = {};\n    }\n\n    attr = attr || {};\n    var baseInverted = Object.keys(base).reduce(function (memo, key) {\n      if (base[key] !== attr[key] && attr[key] !== undefined) {\n        memo[key] = base[key];\n      }\n\n      return memo;\n    }, {});\n    return Object.keys(attr).reduce(function (memo, key) {\n      if (attr[key] !== base[key] && base[key] === undefined) {\n        memo[key] = null;\n      }\n\n      return memo;\n    }, baseInverted);\n  }\n\n  AttributeMap.invert = invert;\n\n  function transform(a, b, priority) {\n    if (priority === void 0) {\n      priority = false;\n    }\n\n    if (typeof a !== 'object') {\n      return b;\n    }\n\n    if (typeof b !== 'object') {\n      return undefined;\n    }\n\n    if (!priority) {\n      return b; // b simply overwrites us without priority\n    }\n\n    var attributes = Object.keys(b).reduce(function (attrs, key) {\n      if (a[key] === undefined) {\n        attrs[key] = b[key]; // null is a valid value\n      }\n\n      return attrs;\n    }, {});\n    return Object.keys(attributes).length > 0 ? attributes : undefined;\n  }\n\n  AttributeMap.transform = transform;\n})(AttributeMap || (AttributeMap = {}));\n\nexports.default = AttributeMap;","map":{"version":3,"mappings":"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","names":["AttributeMap","compose","a","b","keepNull","attributes","lodash_clonedeep_1","Object","keys","reduce","copy","key","undefined","length","diff","concat","attrs","lodash_isequal_1","invert","attr","base","baseInverted","memo","transform","priority","exports"],"sourceRoot":"","sources":["../src/AttributeMap.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}