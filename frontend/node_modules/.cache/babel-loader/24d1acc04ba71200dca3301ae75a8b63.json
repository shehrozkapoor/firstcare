{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nimport \"core-js/modules/es.object.set-prototype-of.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\n\nvar _templateObject, _templateObject2;\n\nfunction _taggedTemplateLiteral(strings, raw) {\n  if (!raw) {\n    raw = strings.slice(0);\n  }\n\n  return Object.freeze(Object.defineProperties(strings, {\n    raw: {\n      value: Object.freeze(raw)\n    }\n  }));\n}\n\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.weak-map.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get.apply(this, arguments);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) {\n  _checkPrivateRedeclaration(obj, privateMap);\n\n  privateMap.set(obj, value);\n}\n\nfunction _checkPrivateRedeclaration(obj, privateCollection) {\n  if (privateCollection.has(obj)) {\n    throw new TypeError(\"Cannot initialize the same private elements twice on an object\");\n  }\n}\n\nfunction _classPrivateFieldSet(receiver, privateMap, value) {\n  var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\");\n\n  _classApplyDescriptorSet(receiver, descriptor, value);\n\n  return value;\n}\n\nfunction _classApplyDescriptorSet(receiver, descriptor, value) {\n  if (descriptor.set) {\n    descriptor.set.call(receiver, value);\n  } else {\n    if (!descriptor.writable) {\n      throw new TypeError(\"attempted to set read only private field\");\n    }\n\n    descriptor.value = value;\n  }\n}\n\nfunction _classPrivateFieldGet(receiver, privateMap) {\n  var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\");\n\n  return _classApplyDescriptorGet(receiver, descriptor);\n}\n\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) {\n  if (!privateMap.has(receiver)) {\n    throw new TypeError(\"attempted to \" + action + \" private field on non-instance\");\n  }\n\n  return privateMap.get(receiver);\n}\n\nfunction _classApplyDescriptorGet(receiver, descriptor) {\n  if (descriptor.get) {\n    return descriptor.get.call(receiver);\n  }\n\n  return descriptor.value;\n}\n\nimport { addClass, removeClass, fastInnerHTML, empty } from \"../../helpers/dom/element.mjs\";\nimport { isNumeric } from \"../../helpers/number.mjs\";\nimport { isLeftClick, isRightClick } from \"../../helpers/dom/event.mjs\";\nimport { toSingleLine } from \"../../helpers/templateLiteralTag.mjs\";\nimport { warn } from \"../../helpers/console.mjs\";\nimport { ACTIVE_HEADER_TYPE, HEADER_TYPE } from \"../../selection/index.mjs\";\nimport { BasePlugin } from \"../base/index.mjs\";\nimport StateManager from \"./stateManager/index.mjs\";\nimport GhostTable from \"./utils/ghostTable.mjs\";\nexport var PLUGIN_KEY = 'nestedHeaders';\nexport var PLUGIN_PRIORITY = 280;\n/**\n * @plugin NestedHeaders\n * @class NestedHeaders\n *\n * @description\n * The plugin allows to create a nested header structure, using the HTML's colspan attribute.\n *\n * To make any header wider (covering multiple table columns), it's corresponding configuration array element should be\n * provided as an object with `label` and `colspan` properties. The `label` property defines the header's label,\n * while the `colspan` property defines a number of columns that the header should cover.\n *\n * __Note__ that the plugin supports a *nested* structure, which means, any header cannot be wider than it's \"parent\". In\n * other words, headers cannot overlap each other.\n * @example\n *\n * ```js\n * const container = document.getElementById('example');\n * const hot = new Handsontable(container, {\n *   data: getData(),\n *   nestedHeaders: [\n *     ['A', {label: 'B', colspan: 8}, 'C'],\n *     ['D', {label: 'E', colspan: 4}, {label: 'F', colspan: 4}, 'G'],\n *     ['H', {label: 'I', colspan: 2}, {label: 'J', colspan: 2}, {label: 'K', colspan: 2}, {label: 'L', colspan: 2}, 'M'],\n *     ['N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W']\n *  ],\n * ```\n */\n\nvar _stateManager = /*#__PURE__*/new WeakMap();\n\nvar _hidingIndexMapObserver = /*#__PURE__*/new WeakMap();\n\nexport var NestedHeaders = /*#__PURE__*/function (_BasePlugin) {\n  _inherits(NestedHeaders, _BasePlugin);\n\n  var _super = _createSuper(NestedHeaders);\n\n  function NestedHeaders() {\n    var _this;\n\n    _classCallCheck(this, NestedHeaders);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _classPrivateFieldInitSpec(_assertThisInitialized(_this), _stateManager, {\n      writable: true,\n      value: new StateManager()\n    });\n\n    _classPrivateFieldInitSpec(_assertThisInitialized(_this), _hidingIndexMapObserver, {\n      writable: true,\n      value: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"ghostTable\", new GhostTable(_assertThisInitialized(_this)));\n\n    _defineProperty(_assertThisInitialized(_this), \"detectedOverlappedHeaders\", false);\n\n    return _this;\n  }\n\n  _createClass(NestedHeaders, [{\n    key: \"isEnabled\",\n    value:\n    /**\n     * Check if plugin is enabled.\n     *\n     * @returns {boolean}\n     */\n    function isEnabled() {\n      return !!this.hot.getSettings()[PLUGIN_KEY];\n    }\n    /**\n     * Enables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this2 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      var _this$hot$getSettings = this.hot.getSettings(),\n          nestedHeaders = _this$hot$getSettings.nestedHeaders;\n\n      if (!Array.isArray(nestedHeaders) || !Array.isArray(nestedHeaders[0])) {\n        warn(toSingleLine(_templateObject || (_templateObject = _taggedTemplateLiteral([\"Your Nested Headers plugin configuration is invalid. The settings has to be \\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]\"], [\"Your Nested Headers plugin configuration is invalid. The settings has to be\\\\x20\\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]\"]))));\n      }\n\n      this.addHook('init', function () {\n        return _this2.onInit();\n      });\n      this.addHook('afterLoadData', function () {\n        return _this2.onAfterLoadData.apply(_this2, arguments);\n      });\n      this.addHook('beforeOnCellMouseDown', function () {\n        return _this2.onBeforeOnCellMouseDown.apply(_this2, arguments);\n      });\n      this.addHook('afterOnCellMouseDown', function () {\n        return _this2.onAfterOnCellMouseDown.apply(_this2, arguments);\n      });\n      this.addHook('beforeOnCellMouseOver', function () {\n        return _this2.onBeforeOnCellMouseOver.apply(_this2, arguments);\n      });\n      this.addHook('afterGetColumnHeaderRenderers', function (array) {\n        return _this2.onAfterGetColumnHeaderRenderers(array);\n      });\n      this.addHook('modifyColWidth', function () {\n        return _this2.onModifyColWidth.apply(_this2, arguments);\n      });\n      this.addHook('beforeHighlightingColumnHeader', function () {\n        return _this2.onBeforeHighlightingColumnHeader.apply(_this2, arguments);\n      });\n      this.addHook('afterViewportColumnCalculatorOverride', function () {\n        return _this2.onAfterViewportColumnCalculatorOverride.apply(_this2, arguments);\n      });\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"enablePlugin\", this).call(this);\n\n      this.updatePlugin(); // @TODO: Workaround for broken plugin initialization abstraction.\n    }\n    /**\n     * Updates the plugin state. This method is executed when {@link Core#updateSettings} is invoked.\n     */\n\n  }, {\n    key: \"updatePlugin\",\n    value: function updatePlugin() {\n      var _this3 = this;\n\n      if (!this.hot.view) {\n        // @TODO: Workaround for broken plugin initialization abstraction.\n        return;\n      }\n\n      var _this$hot$getSettings2 = this.hot.getSettings(),\n          nestedHeaders = _this$hot$getSettings2.nestedHeaders;\n\n      _classPrivateFieldGet(this, _stateManager).setColumnsLimit(this.hot.countCols());\n\n      if (Array.isArray(nestedHeaders)) {\n        this.detectedOverlappedHeaders = _classPrivateFieldGet(this, _stateManager).setState(nestedHeaders);\n      }\n\n      if (this.detectedOverlappedHeaders) {\n        warn(toSingleLine(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \\n                        is currently not supported.\"], [\"Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\\\x20\\n                        is currently not supported.\"]))));\n      }\n\n      if (this.enabled) {\n        // This line covers the case when a developer uses the external hiding maps to manipulate\n        // the columns' visibility. The tree state built from the settings - which is always built\n        // as if all the columns are visible, needs to be modified to be in sync with a dataset.\n        this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function (isColumnHidden, physicalColumnIndex) {\n          var actionName = isColumnHidden === true ? 'hide-column' : 'show-column';\n\n          _classPrivateFieldGet(_this3, _stateManager).triggerColumnModification(actionName, physicalColumnIndex);\n        });\n      }\n\n      if (!_classPrivateFieldGet(this, _hidingIndexMapObserver) && this.enabled) {\n        _classPrivateFieldSet(this, _hidingIndexMapObserver, this.hot.columnIndexMapper.createChangesObserver('hiding').subscribe(function (changes) {\n          changes.forEach(function (_ref) {\n            var op = _ref.op,\n                columnIndex = _ref.index,\n                newValue = _ref.newValue;\n\n            if (op === 'replace') {\n              var actionName = newValue === true ? 'hide-column' : 'show-column';\n\n              _classPrivateFieldGet(_this3, _stateManager).triggerColumnModification(actionName, columnIndex);\n            }\n          });\n        }));\n      }\n\n      this.ghostTable.buildWidthsMapper();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"updatePlugin\", this).call(this);\n    }\n    /**\n     * Disables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      this.clearColspans();\n\n      _classPrivateFieldGet(this, _stateManager).clear();\n\n      _classPrivateFieldGet(this, _hidingIndexMapObserver).unsubscribe();\n\n      _classPrivateFieldSet(this, _hidingIndexMapObserver, null);\n\n      this.ghostTable.clear();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"disablePlugin\", this).call(this);\n    }\n    /**\n     * Returns an instance of the internal state manager of the plugin.\n     *\n     * @private\n     * @returns {StateManager}\n     */\n\n  }, {\n    key: \"getStateManager\",\n    value: function getStateManager() {\n      return _classPrivateFieldGet(this, _stateManager);\n    }\n    /**\n     * Gets a total number of headers levels.\n     *\n     * @private\n     * @returns {number}\n     */\n\n  }, {\n    key: \"getLayersCount\",\n    value: function getLayersCount() {\n      return _classPrivateFieldGet(this, _stateManager).getLayersCount();\n    }\n    /**\n     * Gets column settings for a specified header. The returned object contains\n     * information about the header label, its colspan length, or if it is hidden\n     * in the header renderers.\n     *\n     * @private\n     * @param {number} headerLevel Header level (0 = most distant to the table).\n     * @param {number} columnIndex A visual column index.\n     * @returns {object}\n     */\n\n  }, {\n    key: \"getHeaderSettings\",\n    value: function getHeaderSettings(headerLevel, columnIndex) {\n      return _classPrivateFieldGet(this, _stateManager).getHeaderSettings(headerLevel, columnIndex);\n    }\n    /**\n     * Clear the colspans remaining after plugin usage.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"clearColspans\",\n    value: function clearColspans() {\n      if (!this.hot.view) {\n        return;\n      }\n\n      var wt = this.hot.view.wt;\n      var headerLevels = wt.getSetting('columnHeaders').length;\n      var mainHeaders = wt.wtTable.THEAD;\n      var topHeaders = wt.wtOverlays.topOverlay.clone.wtTable.THEAD;\n      var topLeftCornerHeaders = wt.wtOverlays.topLeftCornerOverlay ? wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD : null;\n\n      for (var i = 0; i < headerLevels; i++) {\n        var masterLevel = mainHeaders.childNodes[i];\n\n        if (!masterLevel) {\n          break;\n        }\n\n        var topLevel = topHeaders.childNodes[i];\n        var topLeftCornerLevel = topLeftCornerHeaders ? topLeftCornerHeaders.childNodes[i] : null;\n\n        for (var j = 0, masterNodes = masterLevel.childNodes.length; j < masterNodes; j++) {\n          masterLevel.childNodes[j].removeAttribute('colspan');\n          removeClass(masterLevel.childNodes[j], 'hiddenHeader');\n\n          if (topLevel && topLevel.childNodes[j]) {\n            topLevel.childNodes[j].removeAttribute('colspan');\n            removeClass(topLevel.childNodes[j], 'hiddenHeader');\n          }\n\n          if (topLeftCornerHeaders && topLeftCornerLevel && topLeftCornerLevel.childNodes[j]) {\n            topLeftCornerLevel.childNodes[j].removeAttribute('colspan');\n            removeClass(topLeftCornerLevel.childNodes[j], 'hiddenHeader');\n          }\n        }\n      }\n    }\n    /**\n     * Generates the appropriate header renderer for a header row.\n     *\n     * @private\n     * @param {number} headerLevel The index of header level counting from the top (positive\n     *                             values counting from 0 to N).\n     * @returns {Function}\n     * @fires Hooks#afterGetColHeader\n     */\n\n  }, {\n    key: \"headerRendererFactory\",\n    value: function headerRendererFactory(headerLevel) {\n      var _this4 = this;\n\n      var fixedColumnsLeft = this.hot.view.wt.getSetting('fixedColumnsLeft');\n      return function (renderedColumnIndex, TH) {\n        var _classPrivateFieldGet2;\n\n        var _this4$hot = _this4.hot,\n            rootDocument = _this4$hot.rootDocument,\n            columnIndexMapper = _this4$hot.columnIndexMapper,\n            view = _this4$hot.view;\n        var visualColumnsIndex = columnIndexMapper.getVisualFromRenderableIndex(renderedColumnIndex);\n\n        if (visualColumnsIndex === null) {\n          visualColumnsIndex = renderedColumnIndex;\n        }\n\n        TH.removeAttribute('colspan');\n        removeClass(TH, 'hiddenHeader');\n\n        var _ref2 = (_classPrivateFieldGet2 = _classPrivateFieldGet(_this4, _stateManager).getHeaderSettings(headerLevel, visualColumnsIndex)) !== null && _classPrivateFieldGet2 !== void 0 ? _classPrivateFieldGet2 : {\n          label: ''\n        },\n            colspan = _ref2.colspan,\n            label = _ref2.label,\n            isHidden = _ref2.isHidden,\n            isPlaceholder = _ref2.isPlaceholder;\n\n        if (isPlaceholder || isHidden) {\n          addClass(TH, 'hiddenHeader');\n        } else if (colspan > 1) {\n          var _view$wt$wtOverlays$t, _view$wt$wtOverlays$l;\n\n          var isTopLeftOverlay = (_view$wt$wtOverlays$t = view.wt.wtOverlays.topLeftCornerOverlay) === null || _view$wt$wtOverlays$t === void 0 ? void 0 : _view$wt$wtOverlays$t.clone.wtTable.THEAD.contains(TH);\n          var isLeftOverlay = (_view$wt$wtOverlays$l = view.wt.wtOverlays.leftOverlay) === null || _view$wt$wtOverlays$l === void 0 ? void 0 : _view$wt$wtOverlays$l.clone.wtTable.THEAD.contains(TH); // Check if there is a fixed column enabled, if so then reduce colspan to fixed column width.\n\n          var correctedColspan = isTopLeftOverlay || isLeftOverlay ? Math.min(colspan, fixedColumnsLeft - renderedColumnIndex) : colspan;\n\n          if (correctedColspan > 1) {\n            TH.setAttribute('colspan', correctedColspan);\n          }\n        }\n\n        var divEl = rootDocument.createElement('div');\n        var spanEl = rootDocument.createElement('span');\n        addClass(divEl, 'relative');\n        addClass(spanEl, 'colHeader');\n        fastInnerHTML(spanEl, label);\n        divEl.appendChild(spanEl);\n        empty(TH);\n        TH.appendChild(divEl);\n\n        _this4.hot.runHooks('afterGetColHeader', visualColumnsIndex, TH);\n      };\n    }\n    /**\n     * Allows to control which header DOM element will be used to highlight.\n     *\n     * @private\n     * @param {number} visualColumn A visual column index of the highlighted row header.\n     * @param {number} headerLevel A row header level that is currently highlighted.\n     * @param {object} highlightMeta An object with meta data that describes the highlight state.\n     * @returns {number}\n     */\n\n  }, {\n    key: \"onBeforeHighlightingColumnHeader\",\n    value: function onBeforeHighlightingColumnHeader(visualColumn, headerLevel, highlightMeta) {\n      var headerNodeData = _classPrivateFieldGet(this, _stateManager).getHeaderTreeNodeData(headerLevel, visualColumn);\n\n      if (!headerNodeData) {\n        return visualColumn;\n      }\n\n      var classNames = highlightMeta.classNames,\n          columnCursor = highlightMeta.columnCursor,\n          selectionType = highlightMeta.selectionType,\n          selectionWidth = highlightMeta.selectionWidth;\n\n      var _classPrivateFieldGet3 = _classPrivateFieldGet(this, _stateManager).getHeaderSettings(headerLevel, visualColumn),\n          isRoot = _classPrivateFieldGet3.isRoot,\n          colspan = _classPrivateFieldGet3.colspan;\n\n      if (selectionType === HEADER_TYPE) {\n        if (!isRoot) {\n          return headerNodeData.columnIndex;\n        }\n      } else if (selectionType === ACTIVE_HEADER_TYPE) {\n        if (colspan > selectionWidth - columnCursor || !isRoot) {\n          // Reset the class names array so the generated TH element won't be modified.\n          classNames.length = 0;\n        }\n      }\n\n      return visualColumn;\n    }\n    /**\n     * Allows to block the column selection that is controlled by the core Selection module.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {CellCoords} coords Cell coords object containing the visual coordinates of the clicked cell.\n     * @param {CellCoords} TD The table cell or header element.\n     * @param {object} controller An object with properties `row`, `column` and `cell`. Each property contains\n     *                            a boolean value that allows or disallows changing the selection for that particular area.\n     */\n\n  }, {\n    key: \"onBeforeOnCellMouseDown\",\n    value: function onBeforeOnCellMouseDown(event, coords, TD, controller) {\n      var headerNodeData = this._getHeaderTreeNodeDataByCoords(coords);\n\n      if (headerNodeData) {\n        // Block the Selection module in controlling how the columns are selected. Pass the\n        // responsibility of the column selection to this plugin (see \"onAfterOnCellMouseDown\" hook).\n        controller.column = true;\n      }\n    }\n    /**\n     * Allows to control how the column selection based on the coordinates and the nested headers is made.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {CellCoords} coords Cell coords object containing the visual coordinates of the clicked cell.\n     */\n\n  }, {\n    key: \"onAfterOnCellMouseDown\",\n    value: function onAfterOnCellMouseDown(event, coords) {\n      var headerNodeData = this._getHeaderTreeNodeDataByCoords(coords);\n\n      if (!headerNodeData) {\n        return;\n      }\n\n      var selection = this.hot.selection;\n      var currentSelection = selection.isSelected() ? selection.getSelectedRange().current() : null;\n      var columnsToSelect = [];\n      var columnIndex = headerNodeData.columnIndex,\n          origColspan = headerNodeData.origColspan; // The Selection module doesn't allow it to extend its behavior easily. That's why here we need\n      // to re-implement the \"click\" and \"shift\" behavior. As a workaround, the logic for the nested\n      // headers must implement a similar logic as in the original Selection handler\n      // (see src/selection/mouseEventHandler.js).\n\n      var allowRightClickSelection = !selection.inInSelection(coords);\n\n      if (event.shiftKey && currentSelection) {\n        if (coords.col < currentSelection.from.col) {\n          columnsToSelect.push(currentSelection.getTopRightCorner().col, columnIndex, coords.row);\n        } else if (coords.col > currentSelection.from.col) {\n          columnsToSelect.push(currentSelection.getTopLeftCorner().col, columnIndex + origColspan - 1, coords.row);\n        } else {\n          columnsToSelect.push(columnIndex, columnIndex + origColspan - 1, coords.row);\n        }\n      } else if (isLeftClick(event) || isRightClick(event) && allowRightClickSelection) {\n        columnsToSelect.push(columnIndex, columnIndex + origColspan - 1, coords.row);\n      } // The plugin takes control of the how the columns are selected.\n\n\n      selection.selectColumns.apply(selection, columnsToSelect);\n    }\n    /**\n     * Makes the header-selection properly select the nested headers.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {CellCoords} coords Cell coords object containing the visual coordinates of the clicked cell.\n     * @param {HTMLElement} TD The cell element.\n     * @param {object} controller An object with properties `row`, `column` and `cell`. Each property contains\n     *                            a boolean value that allows or disallows changing the selection for that particular area.\n     */\n\n  }, {\n    key: \"onBeforeOnCellMouseOver\",\n    value: function onBeforeOnCellMouseOver(event, coords, TD, controller) {\n      var _this$hot;\n\n      if (!this.hot.view.isMouseDown()) {\n        return;\n      }\n\n      var headerNodeData = this._getHeaderTreeNodeDataByCoords(coords);\n\n      if (!headerNodeData) {\n        return;\n      }\n\n      var columnIndex = headerNodeData.columnIndex,\n          origColspan = headerNodeData.origColspan;\n      var selectedRange = this.hot.getSelectedRangeLast();\n      var topLeftCoords = selectedRange.getTopLeftCorner();\n      var bottomRightCoords = selectedRange.getBottomRightCorner();\n      var from = selectedRange.from; // Block the Selection module in controlling how the columns and cells are selected.\n      // From now on, the plugin is responsible for the selection.\n\n      controller.column = true;\n      controller.cell = true;\n      var columnsToSelect = [];\n\n      if (coords.col < from.col) {\n        columnsToSelect.push(bottomRightCoords.col, columnIndex);\n      } else if (coords.col > from.col) {\n        columnsToSelect.push(topLeftCoords.col, columnIndex + origColspan - 1);\n      } else {\n        columnsToSelect.push(columnIndex, columnIndex + origColspan - 1);\n      }\n\n      (_this$hot = this.hot).selectColumns.apply(_this$hot, columnsToSelect);\n    }\n    /**\n     * `afterGetColumnHeader` hook callback - prepares the header structure.\n     *\n     * @private\n     * @param {Array} renderersArray Array of renderers.\n     */\n\n  }, {\n    key: \"onAfterGetColumnHeaderRenderers\",\n    value: function onAfterGetColumnHeaderRenderers(renderersArray) {\n      if (renderersArray) {\n        renderersArray.length = 0;\n\n        for (var headerLayer = 0; headerLayer < _classPrivateFieldGet(this, _stateManager).getLayersCount(); headerLayer++) {\n          renderersArray.push(this.headerRendererFactory(headerLayer));\n        }\n      }\n    }\n    /**\n     * Make the renderer render the first nested column in its entirety.\n     *\n     * @private\n     * @param {object} calc Viewport column calculator.\n     */\n\n  }, {\n    key: \"onAfterViewportColumnCalculatorOverride\",\n    value: function onAfterViewportColumnCalculatorOverride(calc) {\n      var headerLayersCount = _classPrivateFieldGet(this, _stateManager).getLayersCount();\n\n      var newStartColumn = calc.startColumn;\n      var nonRenderable = !!headerLayersCount;\n\n      for (var headerLayer = 0; headerLayer < headerLayersCount; headerLayer++) {\n        var startColumn = _classPrivateFieldGet(this, _stateManager).findLeftMostColumnIndex(headerLayer, calc.startColumn);\n\n        var renderedStartColumn = this.hot.columnIndexMapper.getRenderableFromVisualIndex(startColumn); // If any of the headers for that column index is rendered, all of them should be rendered properly, see\n        // comment below.\n\n        if (startColumn >= 0) {\n          nonRenderable = false;\n        } // `renderedStartColumn` can be `null` if the leftmost columns are hidden. In that case -> ignore that header\n        // level, as it should be handled by the \"parent\" header\n\n\n        if (isNumeric(renderedStartColumn) && renderedStartColumn < calc.startColumn) {\n          newStartColumn = renderedStartColumn;\n          break;\n        }\n      } // If no headers for the provided column index are renderable, start rendering from the beginning of the upmost\n      // header for that position.\n\n\n      calc.startColumn = nonRenderable ? _classPrivateFieldGet(this, _stateManager).getHeaderTreeNodeData(0, newStartColumn).columnIndex : newStartColumn;\n    }\n    /**\n     * `modifyColWidth` hook callback - returns width from cache, when is greater than incoming from hook.\n     *\n     * @private\n     * @param {number} width Width from hook.\n     * @param {number} column Visual index of an column.\n     * @returns {number}\n     */\n\n  }, {\n    key: \"onModifyColWidth\",\n    value: function onModifyColWidth(width, column) {\n      var cachedWidth = this.ghostTable.widthsCache[column];\n      return width > cachedWidth ? width : cachedWidth;\n    }\n    /**\n     * Updates the plugin state after HoT initialization.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onInit\",\n    value: function onInit() {\n      // @TODO: Workaround for broken plugin initialization abstraction.\n      this.updatePlugin();\n    }\n    /**\n     * Updates the plugin state after new dataset load.\n     *\n     * @private\n     * @param {Array[]} sourceData Array of arrays or array of objects containing data.\n     * @param {boolean} initialLoad Flag that determines whether the data has been loaded\n     *                              during the initialization.\n     */\n\n  }, {\n    key: \"onAfterLoadData\",\n    value: function onAfterLoadData(sourceData, initialLoad) {\n      if (!initialLoad) {\n        this.updatePlugin();\n      }\n    }\n    /**\n     * Destroys the plugin instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      _classPrivateFieldSet(this, _stateManager, null);\n\n      if (_classPrivateFieldGet(this, _hidingIndexMapObserver) !== null) {\n        _classPrivateFieldGet(this, _hidingIndexMapObserver).unsubscribe();\n\n        _classPrivateFieldSet(this, _hidingIndexMapObserver, null);\n      }\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"destroy\", this).call(this);\n    }\n    /**\n     * Gets the tree data that belongs to the column headers pointed by the passed coordinates.\n     *\n     * @private\n     * @param {CellCoords} coords The CellCoords instance.\n     * @returns {object|undefined}\n     */\n\n  }, {\n    key: \"_getHeaderTreeNodeDataByCoords\",\n    value: function _getHeaderTreeNodeDataByCoords(coords) {\n      if (coords.row >= 0 || coords.col < 0) {\n        return;\n      }\n\n      return _classPrivateFieldGet(this, _stateManager).getHeaderTreeNodeData(coords.row, coords.col);\n    }\n  }], [{\n    key: \"PLUGIN_KEY\",\n    get: function get() {\n      return PLUGIN_KEY;\n    }\n  }, {\n    key: \"PLUGIN_PRIORITY\",\n    get: function get() {\n      return PLUGIN_PRIORITY;\n    }\n    /**\n     * The state manager for the nested headers.\n     *\n     * @private\n     * @type {StateManager}\n     */\n\n  }]);\n\n  return NestedHeaders;\n}(BasePlugin);","map":{"version":3,"sources":["/Users/shehrozkapoor/Desktop/FIRST_CARE/firstcare-frontend/node_modules/handsontable/plugins/nestedHeaders/nestedHeaders.mjs"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_templateObject","_templateObject2","_taggedTemplateLiteral","strings","raw","slice","Object","freeze","defineProperties","value","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","key","_createClass","protoProps","staticProps","_get","Reflect","get","property","receiver","base","_superPropBase","desc","getOwnPropertyDescriptor","call","arguments","apply","object","hasOwnProperty","_getPrototypeOf","_inherits","subClass","superClass","create","_setPrototypeOf","o","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","result","NewTarget","construct","_possibleConstructorReturn","self","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","valueOf","e","getPrototypeOf","_defineProperty","_classPrivateFieldInitSpec","privateMap","_checkPrivateRedeclaration","set","privateCollection","has","_classPrivateFieldSet","_classExtractFieldDescriptor","_classApplyDescriptorSet","_classPrivateFieldGet","_classApplyDescriptorGet","action","addClass","removeClass","fastInnerHTML","empty","isNumeric","isLeftClick","isRightClick","toSingleLine","warn","ACTIVE_HEADER_TYPE","HEADER_TYPE","BasePlugin","StateManager","GhostTable","PLUGIN_KEY","PLUGIN_PRIORITY","_stateManager","WeakMap","_hidingIndexMapObserver","NestedHeaders","_BasePlugin","_super","_this","_len","args","Array","_key","concat","isEnabled","hot","getSettings","enablePlugin","_this2","enabled","_this$hot$getSettings","nestedHeaders","isArray","addHook","onInit","onAfterLoadData","onBeforeOnCellMouseDown","onAfterOnCellMouseDown","onBeforeOnCellMouseOver","array","onAfterGetColumnHeaderRenderers","onModifyColWidth","onBeforeHighlightingColumnHeader","onAfterViewportColumnCalculatorOverride","updatePlugin","_this3","view","_this$hot$getSettings2","setColumnsLimit","countCols","detectedOverlappedHeaders","setState","columnIndexMapper","hidingMapsCollection","getMergedValues","forEach","isColumnHidden","physicalColumnIndex","actionName","triggerColumnModification","createChangesObserver","subscribe","changes","_ref","op","columnIndex","index","newValue","ghostTable","buildWidthsMapper","disablePlugin","clearColspans","clear","unsubscribe","getStateManager","getLayersCount","getHeaderSettings","headerLevel","wt","headerLevels","getSetting","mainHeaders","wtTable","THEAD","topHeaders","wtOverlays","topOverlay","clone","topLeftCornerHeaders","topLeftCornerOverlay","masterLevel","childNodes","topLevel","topLeftCornerLevel","j","masterNodes","removeAttribute","headerRendererFactory","_this4","fixedColumnsLeft","renderedColumnIndex","TH","_classPrivateFieldGet2","_this4$hot","rootDocument","visualColumnsIndex","getVisualFromRenderableIndex","_ref2","label","colspan","isHidden","isPlaceholder","_view$wt$wtOverlays$t","_view$wt$wtOverlays$l","isTopLeftOverlay","contains","isLeftOverlay","leftOverlay","correctedColspan","Math","min","setAttribute","divEl","createElement","spanEl","appendChild","runHooks","visualColumn","highlightMeta","headerNodeData","getHeaderTreeNodeData","classNames","columnCursor","selectionType","selectionWidth","_classPrivateFieldGet3","isRoot","event","coords","TD","controller","_getHeaderTreeNodeDataByCoords","column","selection","currentSelection","isSelected","getSelectedRange","current","columnsToSelect","origColspan","allowRightClickSelection","inInSelection","shiftKey","col","from","push","getTopRightCorner","row","getTopLeftCorner","selectColumns","_this$hot","isMouseDown","selectedRange","getSelectedRangeLast","topLeftCoords","bottomRightCoords","getBottomRightCorner","cell","renderersArray","headerLayer","calc","headerLayersCount","newStartColumn","startColumn","nonRenderable","findLeftMostColumnIndex","renderedStartColumn","getRenderableFromVisualIndex","width","cachedWidth","widthsCache","sourceData","initialLoad","destroy"],"mappings":"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","sourcesContent":["function _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\n\nimport \"core-js/modules/es.object.set-prototype-of.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.reflect.get.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.object.freeze.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\n\nvar _templateObject, _templateObject2;\n\nfunction _taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.weak-map.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\n\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classPrivateFieldInitSpec(obj, privateMap, value) { _checkPrivateRedeclaration(obj, privateMap); privateMap.set(obj, value); }\n\nfunction _checkPrivateRedeclaration(obj, privateCollection) { if (privateCollection.has(obj)) { throw new TypeError(\"Cannot initialize the same private elements twice on an object\"); } }\n\nfunction _classPrivateFieldSet(receiver, privateMap, value) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\n\nfunction _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\n\nfunction _classPrivateFieldGet(receiver, privateMap) { var descriptor = _classExtractFieldDescriptor(receiver, privateMap, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\n\nfunction _classExtractFieldDescriptor(receiver, privateMap, action) { if (!privateMap.has(receiver)) { throw new TypeError(\"attempted to \" + action + \" private field on non-instance\"); } return privateMap.get(receiver); }\n\nfunction _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\n\nimport { addClass, removeClass, fastInnerHTML, empty } from \"../../helpers/dom/element.mjs\";\nimport { isNumeric } from \"../../helpers/number.mjs\";\nimport { isLeftClick, isRightClick } from \"../../helpers/dom/event.mjs\";\nimport { toSingleLine } from \"../../helpers/templateLiteralTag.mjs\";\nimport { warn } from \"../../helpers/console.mjs\";\nimport { ACTIVE_HEADER_TYPE, HEADER_TYPE } from \"../../selection/index.mjs\";\nimport { BasePlugin } from \"../base/index.mjs\";\nimport StateManager from \"./stateManager/index.mjs\";\nimport GhostTable from \"./utils/ghostTable.mjs\";\nexport var PLUGIN_KEY = 'nestedHeaders';\nexport var PLUGIN_PRIORITY = 280;\n/**\n * @plugin NestedHeaders\n * @class NestedHeaders\n *\n * @description\n * The plugin allows to create a nested header structure, using the HTML's colspan attribute.\n *\n * To make any header wider (covering multiple table columns), it's corresponding configuration array element should be\n * provided as an object with `label` and `colspan` properties. The `label` property defines the header's label,\n * while the `colspan` property defines a number of columns that the header should cover.\n *\n * __Note__ that the plugin supports a *nested* structure, which means, any header cannot be wider than it's \"parent\". In\n * other words, headers cannot overlap each other.\n * @example\n *\n * ```js\n * const container = document.getElementById('example');\n * const hot = new Handsontable(container, {\n *   data: getData(),\n *   nestedHeaders: [\n *     ['A', {label: 'B', colspan: 8}, 'C'],\n *     ['D', {label: 'E', colspan: 4}, {label: 'F', colspan: 4}, 'G'],\n *     ['H', {label: 'I', colspan: 2}, {label: 'J', colspan: 2}, {label: 'K', colspan: 2}, {label: 'L', colspan: 2}, 'M'],\n *     ['N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W']\n *  ],\n * ```\n */\n\nvar _stateManager = /*#__PURE__*/new WeakMap();\n\nvar _hidingIndexMapObserver = /*#__PURE__*/new WeakMap();\n\nexport var NestedHeaders = /*#__PURE__*/function (_BasePlugin) {\n  _inherits(NestedHeaders, _BasePlugin);\n\n  var _super = _createSuper(NestedHeaders);\n\n  function NestedHeaders() {\n    var _this;\n\n    _classCallCheck(this, NestedHeaders);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _classPrivateFieldInitSpec(_assertThisInitialized(_this), _stateManager, {\n      writable: true,\n      value: new StateManager()\n    });\n\n    _classPrivateFieldInitSpec(_assertThisInitialized(_this), _hidingIndexMapObserver, {\n      writable: true,\n      value: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"ghostTable\", new GhostTable(_assertThisInitialized(_this)));\n\n    _defineProperty(_assertThisInitialized(_this), \"detectedOverlappedHeaders\", false);\n\n    return _this;\n  }\n\n  _createClass(NestedHeaders, [{\n    key: \"isEnabled\",\n    value:\n    /**\n     * Check if plugin is enabled.\n     *\n     * @returns {boolean}\n     */\n    function isEnabled() {\n      return !!this.hot.getSettings()[PLUGIN_KEY];\n    }\n    /**\n     * Enables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"enablePlugin\",\n    value: function enablePlugin() {\n      var _this2 = this;\n\n      if (this.enabled) {\n        return;\n      }\n\n      var _this$hot$getSettings = this.hot.getSettings(),\n          nestedHeaders = _this$hot$getSettings.nestedHeaders;\n\n      if (!Array.isArray(nestedHeaders) || !Array.isArray(nestedHeaders[0])) {\n        warn(toSingleLine(_templateObject || (_templateObject = _taggedTemplateLiteral([\"Your Nested Headers plugin configuration is invalid. The settings has to be \\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]\"], [\"Your Nested Headers plugin configuration is invalid. The settings has to be\\\\x20\\n                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]\"]))));\n      }\n\n      this.addHook('init', function () {\n        return _this2.onInit();\n      });\n      this.addHook('afterLoadData', function () {\n        return _this2.onAfterLoadData.apply(_this2, arguments);\n      });\n      this.addHook('beforeOnCellMouseDown', function () {\n        return _this2.onBeforeOnCellMouseDown.apply(_this2, arguments);\n      });\n      this.addHook('afterOnCellMouseDown', function () {\n        return _this2.onAfterOnCellMouseDown.apply(_this2, arguments);\n      });\n      this.addHook('beforeOnCellMouseOver', function () {\n        return _this2.onBeforeOnCellMouseOver.apply(_this2, arguments);\n      });\n      this.addHook('afterGetColumnHeaderRenderers', function (array) {\n        return _this2.onAfterGetColumnHeaderRenderers(array);\n      });\n      this.addHook('modifyColWidth', function () {\n        return _this2.onModifyColWidth.apply(_this2, arguments);\n      });\n      this.addHook('beforeHighlightingColumnHeader', function () {\n        return _this2.onBeforeHighlightingColumnHeader.apply(_this2, arguments);\n      });\n      this.addHook('afterViewportColumnCalculatorOverride', function () {\n        return _this2.onAfterViewportColumnCalculatorOverride.apply(_this2, arguments);\n      });\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"enablePlugin\", this).call(this);\n\n      this.updatePlugin(); // @TODO: Workaround for broken plugin initialization abstraction.\n    }\n    /**\n     * Updates the plugin state. This method is executed when {@link Core#updateSettings} is invoked.\n     */\n\n  }, {\n    key: \"updatePlugin\",\n    value: function updatePlugin() {\n      var _this3 = this;\n\n      if (!this.hot.view) {\n        // @TODO: Workaround for broken plugin initialization abstraction.\n        return;\n      }\n\n      var _this$hot$getSettings2 = this.hot.getSettings(),\n          nestedHeaders = _this$hot$getSettings2.nestedHeaders;\n\n      _classPrivateFieldGet(this, _stateManager).setColumnsLimit(this.hot.countCols());\n\n      if (Array.isArray(nestedHeaders)) {\n        this.detectedOverlappedHeaders = _classPrivateFieldGet(this, _stateManager).setState(nestedHeaders);\n      }\n\n      if (this.detectedOverlappedHeaders) {\n        warn(toSingleLine(_templateObject2 || (_templateObject2 = _taggedTemplateLiteral([\"Your Nested Headers plugin setup contains overlapping headers. This kind of configuration \\n                        is currently not supported.\"], [\"Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\\\\x20\\n                        is currently not supported.\"]))));\n      }\n\n      if (this.enabled) {\n        // This line covers the case when a developer uses the external hiding maps to manipulate\n        // the columns' visibility. The tree state built from the settings - which is always built\n        // as if all the columns are visible, needs to be modified to be in sync with a dataset.\n        this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(function (isColumnHidden, physicalColumnIndex) {\n          var actionName = isColumnHidden === true ? 'hide-column' : 'show-column';\n\n          _classPrivateFieldGet(_this3, _stateManager).triggerColumnModification(actionName, physicalColumnIndex);\n        });\n      }\n\n      if (!_classPrivateFieldGet(this, _hidingIndexMapObserver) && this.enabled) {\n        _classPrivateFieldSet(this, _hidingIndexMapObserver, this.hot.columnIndexMapper.createChangesObserver('hiding').subscribe(function (changes) {\n          changes.forEach(function (_ref) {\n            var op = _ref.op,\n                columnIndex = _ref.index,\n                newValue = _ref.newValue;\n\n            if (op === 'replace') {\n              var actionName = newValue === true ? 'hide-column' : 'show-column';\n\n              _classPrivateFieldGet(_this3, _stateManager).triggerColumnModification(actionName, columnIndex);\n            }\n          });\n        }));\n      }\n\n      this.ghostTable.buildWidthsMapper();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"updatePlugin\", this).call(this);\n    }\n    /**\n     * Disables the plugin functionality for this Handsontable instance.\n     */\n\n  }, {\n    key: \"disablePlugin\",\n    value: function disablePlugin() {\n      this.clearColspans();\n\n      _classPrivateFieldGet(this, _stateManager).clear();\n\n      _classPrivateFieldGet(this, _hidingIndexMapObserver).unsubscribe();\n\n      _classPrivateFieldSet(this, _hidingIndexMapObserver, null);\n\n      this.ghostTable.clear();\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"disablePlugin\", this).call(this);\n    }\n    /**\n     * Returns an instance of the internal state manager of the plugin.\n     *\n     * @private\n     * @returns {StateManager}\n     */\n\n  }, {\n    key: \"getStateManager\",\n    value: function getStateManager() {\n      return _classPrivateFieldGet(this, _stateManager);\n    }\n    /**\n     * Gets a total number of headers levels.\n     *\n     * @private\n     * @returns {number}\n     */\n\n  }, {\n    key: \"getLayersCount\",\n    value: function getLayersCount() {\n      return _classPrivateFieldGet(this, _stateManager).getLayersCount();\n    }\n    /**\n     * Gets column settings for a specified header. The returned object contains\n     * information about the header label, its colspan length, or if it is hidden\n     * in the header renderers.\n     *\n     * @private\n     * @param {number} headerLevel Header level (0 = most distant to the table).\n     * @param {number} columnIndex A visual column index.\n     * @returns {object}\n     */\n\n  }, {\n    key: \"getHeaderSettings\",\n    value: function getHeaderSettings(headerLevel, columnIndex) {\n      return _classPrivateFieldGet(this, _stateManager).getHeaderSettings(headerLevel, columnIndex);\n    }\n    /**\n     * Clear the colspans remaining after plugin usage.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"clearColspans\",\n    value: function clearColspans() {\n      if (!this.hot.view) {\n        return;\n      }\n\n      var wt = this.hot.view.wt;\n      var headerLevels = wt.getSetting('columnHeaders').length;\n      var mainHeaders = wt.wtTable.THEAD;\n      var topHeaders = wt.wtOverlays.topOverlay.clone.wtTable.THEAD;\n      var topLeftCornerHeaders = wt.wtOverlays.topLeftCornerOverlay ? wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD : null;\n\n      for (var i = 0; i < headerLevels; i++) {\n        var masterLevel = mainHeaders.childNodes[i];\n\n        if (!masterLevel) {\n          break;\n        }\n\n        var topLevel = topHeaders.childNodes[i];\n        var topLeftCornerLevel = topLeftCornerHeaders ? topLeftCornerHeaders.childNodes[i] : null;\n\n        for (var j = 0, masterNodes = masterLevel.childNodes.length; j < masterNodes; j++) {\n          masterLevel.childNodes[j].removeAttribute('colspan');\n          removeClass(masterLevel.childNodes[j], 'hiddenHeader');\n\n          if (topLevel && topLevel.childNodes[j]) {\n            topLevel.childNodes[j].removeAttribute('colspan');\n            removeClass(topLevel.childNodes[j], 'hiddenHeader');\n          }\n\n          if (topLeftCornerHeaders && topLeftCornerLevel && topLeftCornerLevel.childNodes[j]) {\n            topLeftCornerLevel.childNodes[j].removeAttribute('colspan');\n            removeClass(topLeftCornerLevel.childNodes[j], 'hiddenHeader');\n          }\n        }\n      }\n    }\n    /**\n     * Generates the appropriate header renderer for a header row.\n     *\n     * @private\n     * @param {number} headerLevel The index of header level counting from the top (positive\n     *                             values counting from 0 to N).\n     * @returns {Function}\n     * @fires Hooks#afterGetColHeader\n     */\n\n  }, {\n    key: \"headerRendererFactory\",\n    value: function headerRendererFactory(headerLevel) {\n      var _this4 = this;\n\n      var fixedColumnsLeft = this.hot.view.wt.getSetting('fixedColumnsLeft');\n      return function (renderedColumnIndex, TH) {\n        var _classPrivateFieldGet2;\n\n        var _this4$hot = _this4.hot,\n            rootDocument = _this4$hot.rootDocument,\n            columnIndexMapper = _this4$hot.columnIndexMapper,\n            view = _this4$hot.view;\n        var visualColumnsIndex = columnIndexMapper.getVisualFromRenderableIndex(renderedColumnIndex);\n\n        if (visualColumnsIndex === null) {\n          visualColumnsIndex = renderedColumnIndex;\n        }\n\n        TH.removeAttribute('colspan');\n        removeClass(TH, 'hiddenHeader');\n\n        var _ref2 = (_classPrivateFieldGet2 = _classPrivateFieldGet(_this4, _stateManager).getHeaderSettings(headerLevel, visualColumnsIndex)) !== null && _classPrivateFieldGet2 !== void 0 ? _classPrivateFieldGet2 : {\n          label: ''\n        },\n            colspan = _ref2.colspan,\n            label = _ref2.label,\n            isHidden = _ref2.isHidden,\n            isPlaceholder = _ref2.isPlaceholder;\n\n        if (isPlaceholder || isHidden) {\n          addClass(TH, 'hiddenHeader');\n        } else if (colspan > 1) {\n          var _view$wt$wtOverlays$t, _view$wt$wtOverlays$l;\n\n          var isTopLeftOverlay = (_view$wt$wtOverlays$t = view.wt.wtOverlays.topLeftCornerOverlay) === null || _view$wt$wtOverlays$t === void 0 ? void 0 : _view$wt$wtOverlays$t.clone.wtTable.THEAD.contains(TH);\n          var isLeftOverlay = (_view$wt$wtOverlays$l = view.wt.wtOverlays.leftOverlay) === null || _view$wt$wtOverlays$l === void 0 ? void 0 : _view$wt$wtOverlays$l.clone.wtTable.THEAD.contains(TH); // Check if there is a fixed column enabled, if so then reduce colspan to fixed column width.\n\n          var correctedColspan = isTopLeftOverlay || isLeftOverlay ? Math.min(colspan, fixedColumnsLeft - renderedColumnIndex) : colspan;\n\n          if (correctedColspan > 1) {\n            TH.setAttribute('colspan', correctedColspan);\n          }\n        }\n\n        var divEl = rootDocument.createElement('div');\n        var spanEl = rootDocument.createElement('span');\n        addClass(divEl, 'relative');\n        addClass(spanEl, 'colHeader');\n        fastInnerHTML(spanEl, label);\n        divEl.appendChild(spanEl);\n        empty(TH);\n        TH.appendChild(divEl);\n\n        _this4.hot.runHooks('afterGetColHeader', visualColumnsIndex, TH);\n      };\n    }\n    /**\n     * Allows to control which header DOM element will be used to highlight.\n     *\n     * @private\n     * @param {number} visualColumn A visual column index of the highlighted row header.\n     * @param {number} headerLevel A row header level that is currently highlighted.\n     * @param {object} highlightMeta An object with meta data that describes the highlight state.\n     * @returns {number}\n     */\n\n  }, {\n    key: \"onBeforeHighlightingColumnHeader\",\n    value: function onBeforeHighlightingColumnHeader(visualColumn, headerLevel, highlightMeta) {\n      var headerNodeData = _classPrivateFieldGet(this, _stateManager).getHeaderTreeNodeData(headerLevel, visualColumn);\n\n      if (!headerNodeData) {\n        return visualColumn;\n      }\n\n      var classNames = highlightMeta.classNames,\n          columnCursor = highlightMeta.columnCursor,\n          selectionType = highlightMeta.selectionType,\n          selectionWidth = highlightMeta.selectionWidth;\n\n      var _classPrivateFieldGet3 = _classPrivateFieldGet(this, _stateManager).getHeaderSettings(headerLevel, visualColumn),\n          isRoot = _classPrivateFieldGet3.isRoot,\n          colspan = _classPrivateFieldGet3.colspan;\n\n      if (selectionType === HEADER_TYPE) {\n        if (!isRoot) {\n          return headerNodeData.columnIndex;\n        }\n      } else if (selectionType === ACTIVE_HEADER_TYPE) {\n        if (colspan > selectionWidth - columnCursor || !isRoot) {\n          // Reset the class names array so the generated TH element won't be modified.\n          classNames.length = 0;\n        }\n      }\n\n      return visualColumn;\n    }\n    /**\n     * Allows to block the column selection that is controlled by the core Selection module.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {CellCoords} coords Cell coords object containing the visual coordinates of the clicked cell.\n     * @param {CellCoords} TD The table cell or header element.\n     * @param {object} controller An object with properties `row`, `column` and `cell`. Each property contains\n     *                            a boolean value that allows or disallows changing the selection for that particular area.\n     */\n\n  }, {\n    key: \"onBeforeOnCellMouseDown\",\n    value: function onBeforeOnCellMouseDown(event, coords, TD, controller) {\n      var headerNodeData = this._getHeaderTreeNodeDataByCoords(coords);\n\n      if (headerNodeData) {\n        // Block the Selection module in controlling how the columns are selected. Pass the\n        // responsibility of the column selection to this plugin (see \"onAfterOnCellMouseDown\" hook).\n        controller.column = true;\n      }\n    }\n    /**\n     * Allows to control how the column selection based on the coordinates and the nested headers is made.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {CellCoords} coords Cell coords object containing the visual coordinates of the clicked cell.\n     */\n\n  }, {\n    key: \"onAfterOnCellMouseDown\",\n    value: function onAfterOnCellMouseDown(event, coords) {\n      var headerNodeData = this._getHeaderTreeNodeDataByCoords(coords);\n\n      if (!headerNodeData) {\n        return;\n      }\n\n      var selection = this.hot.selection;\n      var currentSelection = selection.isSelected() ? selection.getSelectedRange().current() : null;\n      var columnsToSelect = [];\n      var columnIndex = headerNodeData.columnIndex,\n          origColspan = headerNodeData.origColspan; // The Selection module doesn't allow it to extend its behavior easily. That's why here we need\n      // to re-implement the \"click\" and \"shift\" behavior. As a workaround, the logic for the nested\n      // headers must implement a similar logic as in the original Selection handler\n      // (see src/selection/mouseEventHandler.js).\n\n      var allowRightClickSelection = !selection.inInSelection(coords);\n\n      if (event.shiftKey && currentSelection) {\n        if (coords.col < currentSelection.from.col) {\n          columnsToSelect.push(currentSelection.getTopRightCorner().col, columnIndex, coords.row);\n        } else if (coords.col > currentSelection.from.col) {\n          columnsToSelect.push(currentSelection.getTopLeftCorner().col, columnIndex + origColspan - 1, coords.row);\n        } else {\n          columnsToSelect.push(columnIndex, columnIndex + origColspan - 1, coords.row);\n        }\n      } else if (isLeftClick(event) || isRightClick(event) && allowRightClickSelection) {\n        columnsToSelect.push(columnIndex, columnIndex + origColspan - 1, coords.row);\n      } // The plugin takes control of the how the columns are selected.\n\n\n      selection.selectColumns.apply(selection, columnsToSelect);\n    }\n    /**\n     * Makes the header-selection properly select the nested headers.\n     *\n     * @private\n     * @param {MouseEvent} event Mouse event.\n     * @param {CellCoords} coords Cell coords object containing the visual coordinates of the clicked cell.\n     * @param {HTMLElement} TD The cell element.\n     * @param {object} controller An object with properties `row`, `column` and `cell`. Each property contains\n     *                            a boolean value that allows or disallows changing the selection for that particular area.\n     */\n\n  }, {\n    key: \"onBeforeOnCellMouseOver\",\n    value: function onBeforeOnCellMouseOver(event, coords, TD, controller) {\n      var _this$hot;\n\n      if (!this.hot.view.isMouseDown()) {\n        return;\n      }\n\n      var headerNodeData = this._getHeaderTreeNodeDataByCoords(coords);\n\n      if (!headerNodeData) {\n        return;\n      }\n\n      var columnIndex = headerNodeData.columnIndex,\n          origColspan = headerNodeData.origColspan;\n      var selectedRange = this.hot.getSelectedRangeLast();\n      var topLeftCoords = selectedRange.getTopLeftCorner();\n      var bottomRightCoords = selectedRange.getBottomRightCorner();\n      var from = selectedRange.from; // Block the Selection module in controlling how the columns and cells are selected.\n      // From now on, the plugin is responsible for the selection.\n\n      controller.column = true;\n      controller.cell = true;\n      var columnsToSelect = [];\n\n      if (coords.col < from.col) {\n        columnsToSelect.push(bottomRightCoords.col, columnIndex);\n      } else if (coords.col > from.col) {\n        columnsToSelect.push(topLeftCoords.col, columnIndex + origColspan - 1);\n      } else {\n        columnsToSelect.push(columnIndex, columnIndex + origColspan - 1);\n      }\n\n      (_this$hot = this.hot).selectColumns.apply(_this$hot, columnsToSelect);\n    }\n    /**\n     * `afterGetColumnHeader` hook callback - prepares the header structure.\n     *\n     * @private\n     * @param {Array} renderersArray Array of renderers.\n     */\n\n  }, {\n    key: \"onAfterGetColumnHeaderRenderers\",\n    value: function onAfterGetColumnHeaderRenderers(renderersArray) {\n      if (renderersArray) {\n        renderersArray.length = 0;\n\n        for (var headerLayer = 0; headerLayer < _classPrivateFieldGet(this, _stateManager).getLayersCount(); headerLayer++) {\n          renderersArray.push(this.headerRendererFactory(headerLayer));\n        }\n      }\n    }\n    /**\n     * Make the renderer render the first nested column in its entirety.\n     *\n     * @private\n     * @param {object} calc Viewport column calculator.\n     */\n\n  }, {\n    key: \"onAfterViewportColumnCalculatorOverride\",\n    value: function onAfterViewportColumnCalculatorOverride(calc) {\n      var headerLayersCount = _classPrivateFieldGet(this, _stateManager).getLayersCount();\n\n      var newStartColumn = calc.startColumn;\n      var nonRenderable = !!headerLayersCount;\n\n      for (var headerLayer = 0; headerLayer < headerLayersCount; headerLayer++) {\n        var startColumn = _classPrivateFieldGet(this, _stateManager).findLeftMostColumnIndex(headerLayer, calc.startColumn);\n\n        var renderedStartColumn = this.hot.columnIndexMapper.getRenderableFromVisualIndex(startColumn); // If any of the headers for that column index is rendered, all of them should be rendered properly, see\n        // comment below.\n\n        if (startColumn >= 0) {\n          nonRenderable = false;\n        } // `renderedStartColumn` can be `null` if the leftmost columns are hidden. In that case -> ignore that header\n        // level, as it should be handled by the \"parent\" header\n\n\n        if (isNumeric(renderedStartColumn) && renderedStartColumn < calc.startColumn) {\n          newStartColumn = renderedStartColumn;\n          break;\n        }\n      } // If no headers for the provided column index are renderable, start rendering from the beginning of the upmost\n      // header for that position.\n\n\n      calc.startColumn = nonRenderable ? _classPrivateFieldGet(this, _stateManager).getHeaderTreeNodeData(0, newStartColumn).columnIndex : newStartColumn;\n    }\n    /**\n     * `modifyColWidth` hook callback - returns width from cache, when is greater than incoming from hook.\n     *\n     * @private\n     * @param {number} width Width from hook.\n     * @param {number} column Visual index of an column.\n     * @returns {number}\n     */\n\n  }, {\n    key: \"onModifyColWidth\",\n    value: function onModifyColWidth(width, column) {\n      var cachedWidth = this.ghostTable.widthsCache[column];\n      return width > cachedWidth ? width : cachedWidth;\n    }\n    /**\n     * Updates the plugin state after HoT initialization.\n     *\n     * @private\n     */\n\n  }, {\n    key: \"onInit\",\n    value: function onInit() {\n      // @TODO: Workaround for broken plugin initialization abstraction.\n      this.updatePlugin();\n    }\n    /**\n     * Updates the plugin state after new dataset load.\n     *\n     * @private\n     * @param {Array[]} sourceData Array of arrays or array of objects containing data.\n     * @param {boolean} initialLoad Flag that determines whether the data has been loaded\n     *                              during the initialization.\n     */\n\n  }, {\n    key: \"onAfterLoadData\",\n    value: function onAfterLoadData(sourceData, initialLoad) {\n      if (!initialLoad) {\n        this.updatePlugin();\n      }\n    }\n    /**\n     * Destroys the plugin instance.\n     */\n\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      _classPrivateFieldSet(this, _stateManager, null);\n\n      if (_classPrivateFieldGet(this, _hidingIndexMapObserver) !== null) {\n        _classPrivateFieldGet(this, _hidingIndexMapObserver).unsubscribe();\n\n        _classPrivateFieldSet(this, _hidingIndexMapObserver, null);\n      }\n\n      _get(_getPrototypeOf(NestedHeaders.prototype), \"destroy\", this).call(this);\n    }\n    /**\n     * Gets the tree data that belongs to the column headers pointed by the passed coordinates.\n     *\n     * @private\n     * @param {CellCoords} coords The CellCoords instance.\n     * @returns {object|undefined}\n     */\n\n  }, {\n    key: \"_getHeaderTreeNodeDataByCoords\",\n    value: function _getHeaderTreeNodeDataByCoords(coords) {\n      if (coords.row >= 0 || coords.col < 0) {\n        return;\n      }\n\n      return _classPrivateFieldGet(this, _stateManager).getHeaderTreeNodeData(coords.row, coords.col);\n    }\n  }], [{\n    key: \"PLUGIN_KEY\",\n    get: function get() {\n      return PLUGIN_KEY;\n    }\n  }, {\n    key: \"PLUGIN_PRIORITY\",\n    get: function get() {\n      return PLUGIN_PRIORITY;\n    }\n    /**\n     * The state manager for the nested headers.\n     *\n     * @private\n     * @type {StateManager}\n     */\n\n  }]);\n\n  return NestedHeaders;\n}(BasePlugin);"]},"metadata":{},"sourceType":"module"}